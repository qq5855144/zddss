<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>å·¥ä½œæ—¥è®°</title>
<style>
    :root {
        --bg-color: #E0E5EC;
        --primary-color: #6D5B98;
        --light-shadow: #FFFFFF;
        --dark-shadow: #A3B1C6;
        --text-color: #2D3748;
        --success-color: #48BB78;
        --danger-color: #F56565;
        --card-padding: 15px;
        --card-margin: 10px;
    }

    * {
        box-sizing: border-box;
    }

    html {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        position: relative;
    }

    body {
        font-family: 'Microsoft YaHei', sans-serif;
        padding: 10px;
        width: 100%;
        min-height: 100vh;
        background-color: var(--bg-color);
        color: var(--text-color);
        line-height: 1.4;
        font-size: 14px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        margin: 0;
        padding-bottom: 70px; /* ä¸ºåº•éƒ¨å·¥å…·æ ç•™å‡ºç©ºé—´ */
    }
    
    h1 {
        text-align: center;
        color: var(--primary-color);
        margin: 10px 0 20px 0;
        font-size: 1.6rem;
        font-weight: 700;
        text-shadow: 2px 2px 4px var(--dark-shadow), -2px -2px 4px var(--light-shadow);
        letter-spacing: 0.5px;
        padding: 0 10px;
    }
    
    .toast {
        position: fixed;
        top: 10px;
        left: 10px;
        right: 10px;
        background-color: var(--primary-color);
        color: white;
        padding: 12px;
        border-radius: 15px;
        text-align: center;
        z-index: 1000;
        display: none;
        animation: slideIn 0.3s ease-out;
        box-shadow: 4px 4px 8px var(--dark-shadow), -4px -4px 8px var(--light-shadow);
        font-weight: 500;
        font-size: 14px;
    }
    
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .page {
        display: none;
        animation: fadeIn 0.3s ease;
    }
    
    .page.active {
        display: block;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .section-container {
        background: var(--bg-color);
        border-radius: 20px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 5px 5px 10px var(--dark-shadow), 
                    -5px -5px 10px var(--light-shadow);
    }
    
    .add-form {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .input-row {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    input[type="date"], input[type="text"], input[type="number"] {
        width: 100%;
        padding: 12px 15px;
        border: none;
        border-radius: 12px;
        background-color: var(--bg-color);
        box-shadow: inset 3px 3px 6px var(--dark-shadow), 
                    inset -3px -3px 6px var(--light-shadow);
        color: var(--text-color);
        font-size: 14px;
        transition: all 0.3s ease;
        -webkit-appearance: none;
        appearance: none;
    }
    
    input:focus {
        outline: none;
        box-shadow: inset 2px 2px 4px var(--dark-shadow), 
                    inset -2px -2px 4px var(--light-shadow);
    }
    
    .button-group {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        flex-wrap: wrap;
    }
    
    .button-group button {
        flex: 1;
        margin: 0;
        min-width: 100px;
    }
    
    button {
        padding: 12px 15px;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        background-color: var(--bg-color);
        color: var(--primary-color);
        font-weight: 600;
        font-size: 14px;
        transition: all 0.3s ease;
        box-shadow: 4px 4px 8px var(--dark-shadow), 
                    -4px -4px 8px var(--light-shadow);
    }
    
    button:hover, button:active {
        box-shadow: 2px 2px 4px var(--dark-shadow), 
                    -2px -2px 4px var(--light-shadow);
        transform: translateY(2px);
    }
    
    /* æ·»åŠ è®°å½•æŒ‰é’®ç‰¹æ®Šæ ·å¼ - ä½¿ç”¨é†’ç›®çš„é¢œè‰² */
    .add-button {
        background-color: var(--primary-color) !important;
        color: white !important;
        box-shadow: 4px 4px 8px rgba(109, 91, 152, 0.3), 
                    -4px -4px 8px rgba(255, 255, 255, 0.8) !important;
        font-weight: 700 !important;
        letter-spacing: 0.5px;
    }
    
    .add-button:hover, .add-button:active {
        background-color: #5A4B80 !important;
        box-shadow: 2px 2px 4px rgba(109, 91, 152, 0.3), 
                    -2px -2px 4px rgba(255, 255, 255, 0.8) !important;
        transform: translateY(2px);
    }
    
    /* ä¿®æ”¹è¡¨æ ¼ç»“æ„ï¼šä½¿ç”¨æ›´ç´§å‡‘çš„å¸ƒå±€ï¼Œç§»é™¤æ¨ªå‘æ»šåŠ¨ */
    table {
        width: 100%;
        border-collapse: collapse;
        border-spacing: 0;
    }
    
    th, td {
        padding: 10px 6px;
        text-align: center;
        border-bottom: 1px solid rgba(163, 177, 198, 0.2);
        font-size: 13px;
        word-break: break-word;
        overflow-wrap: break-word;
    }
    
    th {
        background-color: var(--primary-color);
        color: white;
        font-weight: 600;
        position: sticky;
        top: 0;
        z-index: 10;
        white-space: nowrap;
    }
    
    th:first-child {
        border-radius: 15px 0 0 0;
    }
    
    th:last-child {
        border-radius: 0 15px 0 0;
    }
    
    td {
        background-color: var(--bg-color);
    }
    
    tr:last-child td {
        border-bottom: none;
    }
    
    /* è°ƒæ•´åˆ—å®½ï¼Œä½¿å…¶é€‚åº”å°å±å¹• */
    th:nth-child(1), td:nth-child(1) { /* æ—¥æœŸåˆ— */
        width: 18%;
        min-width: 70px;
    }
    
    th:nth-child(2), td:nth-child(2) { /* å·¥ä½œå†…å®¹åˆ— */
        width: 32%;
        min-width: 100px;
        max-width: 150px;
        text-align: left;
        padding-left: 10px;
        padding-right: 10px;
    }
    
    th:nth-child(3), td:nth-child(3) { /* å·¥æ—¶åˆ— */
        width: 15%;
        min-width: 50px;
    }
    
    th:nth-child(4), td:nth-child(4) { /* å·¥èµ„åˆ— */
        width: 20%;
        min-width: 70px;
    }
    
    th:nth-child(5), td:nth-child(5) { /* æ“ä½œåˆ— */
        width: 15%;
        min-width: 70px;
    }
    
    .table-actions {
        display: flex;
        gap: 5px;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .action-btn {
        padding: 5px 8px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 11px;
        transition: all 0.3s ease;
        box-shadow: 2px 2px 4px var(--dark-shadow), 
                    -2px -2px 4px var(--light-shadow);
        white-space: nowrap;
        margin: 2px;
    }
    
    .view-btn {
        background-color: var(--bg-color);
        color: var(--primary-color);
    }
    
    .delete-btn {
        background-color: var(--bg-color);
        color: var(--danger-color);
    }
    
    .action-btn:active {
        box-shadow: inset 2px 2px 4px var(--dark-shadow), 
                    inset -2px -2px 4px var(--light-shadow);
        transform: translateY(2px);
    }
    
    .summary-container {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    .summary-card {
        background: var(--bg-color);
        border-radius: 15px;
        padding: 15px;
        box-shadow: 5px 5px 10px var(--dark-shadow), 
                    -5px -5px 10px var(--light-shadow);
    }
    
    .summary-card h3 {
        color: var(--primary-color);
        margin: 0 0 12px 0;
        font-size: 16px;
        text-align: center;
        padding-bottom: 8px;
        border-bottom: 2px solid rgba(109, 91, 152, 0.2);
    }
    
    .summary-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid rgba(163, 177, 198, 0.2);
    }
    
    .summary-row:last-child {
        border-bottom: none;
    }
    
    .summary-label {
        color: var(--text-color);
        font-weight: 600;
        font-size: 14px;
    }
    
    .summary-value {
        color: var(--primary-color);
        font-weight: 700;
        font-size: 14px;
    }
    
    /* åº•éƒ¨å·¥å…·æ æ ·å¼ */
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: var(--bg-color);
        padding: 10px;
        display: flex;
        justify-content: space-around;
        box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
        z-index: 100;
        border-top: 1px solid rgba(163, 177, 198, 0.3);
    }
    
    .nav-button {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 8px 12px;
        border: none;
        background: transparent;
        color: var(--text-color);
        font-size: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        border-radius: 12px;
        min-width: 70px;
    }
    
    .nav-button i {
        font-size: 20px;
        margin-bottom: 4px;
    }
    
    .nav-button.active {
        color: var(--primary-color);
        background-color: var(--bg-color);
        box-shadow: inset 3px 3px 6px var(--dark-shadow), 
                    inset -3px -3px 6px var(--light-shadow);
        font-weight: 700;
    }
    
    .nav-button:active:not(.active) {
        transform: translateY(2px);
    }
    
    /* éšè—åŸæ¥çš„æ»šåŠ¨æŒ‰é’®ï¼Œå› ä¸ºç°åœ¨æœ‰åº•éƒ¨å¯¼èˆª */
    #scroll-button {
        display: none !important;
    }
    
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    
    .modal-content {
        background: var(--bg-color);
        padding: 20px;
        border-radius: 20px;
        width: 100%;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 10px 10px 20px var(--dark-shadow), 
                    -10px -10px 20px var(--light-shadow);
        position: relative;
    }
    
    .modal-header {
        color: var(--primary-color);
        font-size: 18px;
        margin: 0 0 15px 0;
        font-weight: 700;
        text-align: center;
    }
    
    .modal-body {
        background: var(--bg-color);
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: inset 3px 3px 6px var(--dark-shadow), 
                    inset -3px -3px 6px var(--light-shadow);
        font-size: 14px;
        line-height: 1.6;
        max-height: 50vh;
        overflow-y: auto;
    }
    
    .modal-close {
        display: block;
        width: 100%;
        padding: 12px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        text-align: center;
        box-shadow: 4px 4px 8px var(--dark-shadow), 
                    -4px -4px 8px var(--light-shadow);
    }
    
    .modal-close:active {
        box-shadow: inset 4px 4px 8px rgba(0,0,0,0.2);
    }
    
    /* åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†æ ·å¼ */
    .delete-confirm {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0);
        z-index: 1001;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    
    .delete-confirm-content {
        background: var(--bg-color);
        padding: 25px;
        border-radius: 20px;
        width: 100%;
        max-width: 400px;
        text-align: center;
        box-shadow: 10px 10px 20px var(--dark-shadow), 
                    -10px -10px 20px var(--light-shadow);
    }
    
    .delete-confirm-buttons {
        display: flex;
        gap: 15px;
        margin-top: 20px;
    }
    
    .delete-confirm-buttons button {
        flex: 1;
    }
    
    .delete-confirm-buttons button:first-child {
        background-color: var(--danger-color);
        color: white;
    }
    
    /* å°å±å¹•ä¼˜åŒ– - è¿›ä¸€æ­¥è°ƒæ•´è¡¨æ ¼å¸ƒå±€ */
    @media (max-width: 360px) {
        body {
            padding: 8px;
            font-size: 13px;
            padding-bottom: 60px; /* è°ƒæ•´åº•éƒ¨ç©ºé—´ */
        }
        
        h1 {
            font-size: 1.4rem;
        }
        
        .section-container {
            padding: 12px;
            margin-bottom: 12px;
        }
        
        input[type="date"], input[type="text"], input[type="number"] {
            padding: 10px 12px;
            font-size: 13px;
        }
        
        button {
            padding: 10px 12px;
            font-size: 13px;
        }
        
        th, td {
            padding: 8px 4px;
            font-size: 12px;
        }
        
        /* è¿›ä¸€æ­¥è°ƒæ•´åˆ—å®½ä»¥é€‚åº”å°å±å¹• */
        th:nth-child(1), td:nth-child(1) { /* æ—¥æœŸåˆ— */
            width: 20%;
            min-width: 60px;
        }
        
        th:nth-child(2), td:nth-child(2) { /* å·¥ä½œå†…å®¹åˆ— */
            width: 30%;
            min-width: 80px;
            max-width: 100px;
            padding-left: 6px;
            padding-right: 6px;
        }
        
        th:nth-child(3), td:nth-child(3) { /* å·¥æ—¶åˆ— */
            width: 15%;
            min-width: 40px;
        }
        
        th:nth-child(4), td:nth-child(4) { /* å·¥èµ„åˆ— */
            width: 20%;
            min-width: 60px;
        }
        
        th:nth-child(5), td:nth-child(5) { /* æ“ä½œåˆ— */
            width: 15%;
            min-width: 60px;
        }
        
        .action-btn {
            padding: 4px 6px;
            font-size: 10px;
            margin: 1px;
        }
        
        .summary-card {
            padding: 12px;
        }
        
        .summary-card h3 {
            font-size: 15px;
        }
        
        .summary-label, .summary-value {
            font-size: 13px;
        }
        
        .bottom-nav {
            padding: 8px;
        }
        
        .nav-button {
            padding: 6px 8px;
            font-size: 11px;
            min-width: 60px;
        }
        
        .nav-button i {
            font-size: 18px;
        }
    }
    
    /* æ¨ªå±æ¨¡å¼ä¼˜åŒ– */
    @media (max-height: 500px) and (orientation: landscape) {
        .section-container {
            padding: 10px;
            margin-bottom: 10px;
        }
        
        .add-form {
            flex-direction: row;
            flex-wrap: wrap;
        }
        
        .input-row {
            flex: 1;
            min-width: 150px;
        }
        
        .button-group {
            width: 100%;
        }
        
        .summary-container {
            flex-direction: row;
            flex-wrap: wrap;
        }
        
        .summary-card {
            flex: 1;
            min-width: 200px;
        }
        
        .bottom-nav {
            padding: 5px 10px;
        }
        
        .nav-button {
            padding: 4px 8px;
        }
    }
    
    /* è¶…å°å±å¹•ä¼˜åŒ– - ç®€åŒ–è¡¨æ ¼æ˜¾ç¤º */
    @media (max-width: 320px) {
        th:nth-child(2), td:nth-child(2) { /* å·¥ä½œå†…å®¹åˆ— */
            display: none; /* åœ¨è¶…å°å±å¹•ä¸Šéšè—å·¥ä½œå†…å®¹åˆ— */
        }
        
        th:nth-child(1), td:nth-child(1) {
            width: 25%;
        }
        
        th:nth-child(3), td:nth-child(3) {
            width: 20%;
        }
        
        th:nth-child(4), td:nth-child(4) {
            width: 30%;
        }
        
        th:nth-child(5), td:nth-child(5) {
            width: 25%;
        }
        
        .bottom-nav {
            padding: 6px;
        }
        
        .nav-button {
            min-width: 50px;
            padding: 4px 6px;
            font-size: 10px;
        }
        
        .nav-button i {
            font-size: 16px;
        }
    }
    
    /* é˜²æ­¢iOSè¾“å…¥æ¡†ç¼©æ”¾ */
    @supports (-webkit-overflow-scrolling: touch) {
        input, textarea {
            font-size: 16px !important;
        }
    }
</style>
</head>
<body>
    <h1>å·¥ä½œæ—¥è®°</h1>
    <div class="toast" id="toast"></div>

    <!-- æ·»åŠ é¡µ -->
    <div id="add-page" class="page active">
        <div class="section-container">
            <div class="add-form">
                <div class="input-row">
                    <input type="date" id="date-input" required title="è¯·ç‚¹å‡»é€‰æ‹©å·¥ä½œæ—¥æœŸ" onfocus="this.showPicker()">
                    <input type="text" id="content-input" placeholder="å·¥ä½œå†…å®¹ï¼šä»Šå¤©åšäº†ä»€ä¹ˆï¼ˆé€‰å¡«ï¼‰" title="è¯·è¯¦ç»†å¡«å†™å·¥ä½œå†…å®¹">
                    <input type="number" id="hours-input" min="0" step="0.5" placeholder="å·¥æ—¶ï¼ˆå¤©ï¼‰" title="æŒ‰å¤©è®¡ç®—ï¼ˆ1å¤©=8å°æ—¶ï¼‰" required>
                    <input type="number" id="wage-input" min="0" step="100" placeholder="æ—¥å·¥èµ„ï¼ˆå…ƒï¼‰" title="è¯·è¾“å…¥å½“æ—¥çº¦å®šå·¥èµ„" required>
                </div>
                
                <!-- ä¿®æ”¹è¿™é‡Œï¼šä¸ºæ·»åŠ è®°å½•æŒ‰é’®æ·»åŠ class -->
                <button class="add-button" onclick="addWorkLog()">æ·»åŠ è®°å½•</button>
                
                <div class="button-group">
                    <button onclick="exportData()">å¯¼å‡ºæ•°æ®</button>
                    <button onclick="importData()">å¯¼å…¥æ•°æ®</button>
                    <button onclick="showDeleteAllConfirm()" style="color: var(--danger-color);">åˆ é™¤æ•°æ®</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è¡¨æ ¼é¡µ -->
    <div id="table-page" class="page">
        <div class="section-container">
            <table id="worklog">
                <thead>
                    <tr>
                        <th>æ—¥æœŸ</th>
                        <th>å·¥ä½œå†…å®¹</th>
                        <th>å·¥æ—¶</th>
                        <th>å·¥èµ„</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- æ•°æ®è¡Œå°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- ç»Ÿè®¡é¡µ -->
    <div id="summary-page" class="page">
        <div class="summary-container">
            <div class="summary-card">
                <h3>æœˆåº¦ç»Ÿè®¡</h3>
                <div id="monthly-hours">
                    <!-- æœˆåº¦æ•°æ®å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <div class="summary-card">
                <h3>æ€»è®¡</h3>
                <div class="summary-row">
                    <span class="summary-label">æ€»å·¥æ—¶ï¼š</span>
                    <span class="summary-value" id="total-hours-value">0 å¤©</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">æ€»å·¥èµ„ï¼š</span>
                    <span class="summary-value" id="total-wage-value">0 å…ƒ</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨å·¥å…·æ  -->
    <div class="bottom-nav">
        <button class="nav-button active" onclick="switchPage('add-page')">
            <i>â•</i>
            <span>æ·»åŠ </span>
        </button>
        <button class="nav-button" onclick="switchPage('table-page')">
            <i>ğŸ“‹</i>
            <span>è®°å½•</span>
        </button>
        <button class="nav-button" onclick="switchPage('summary-page')">
            <i>ğŸ“Š</i>
            <span>ç»Ÿè®¡</span>
        </button>
    </div>
    
    <!-- åˆ é™¤ç¡®è®¤å¯¹è¯æ¡† -->
    <div class="delete-confirm" id="delete-confirm">
        <div class="delete-confirm-content">
            <h3>ç¡®è®¤åˆ é™¤</h3>
            <p>ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚</p>
            <div class="delete-confirm-buttons">
                <button onclick="confirmDelete()">ç¡®è®¤åˆ é™¤</button>
                <button onclick="cancelDelete()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
    
    <!-- åˆ é™¤æ‰€æœ‰æ•°æ®ç¡®è®¤å¯¹è¯æ¡† -->
    <div class="delete-confirm" id="delete-all-confirm">
        <div class="delete-confirm-content">
            <h3>ç¡®è®¤åˆ é™¤æ‰€æœ‰æ•°æ®</h3>
            <p>ç¡®å®šè¦åˆ é™¤æ‰€æœ‰å·¥ä½œè®°å½•å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚</p>
            <div class="delete-confirm-buttons">
                <button onclick="confirmDeleteAll()">ç¡®è®¤åˆ é™¤</button>
                <button onclick="cancelDeleteAll()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
<script>
    let workLogs = JSON.parse(localStorage.getItem('workLogs')) || [];
    let lastWage = parseFloat(localStorage.getItem('lastWage')) || 300;
    let lastHours = parseFloat(localStorage.getItem('lastHours')) || 1;
    let deleteIndex = -1;

    // è‡ªåŠ¨æ•´ç†æ—¥æœŸï¼šæŒ‰æ—¥æœŸé™åºæ’åºï¼ˆæœ€æ–°æ—¥æœŸåœ¨æœ€å‰ï¼‰
    function sortWorkLogs() {
        workLogs.sort((a, b) => new Date(b.date) - new Date(a.date));
    }

    function setDefaultDate() {
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        document.getElementById('date-input').value = `${year}-${month}-${day}`;
    }

    function renderTable() {
        // å…ˆæ•´ç†æ—¥æœŸï¼Œç¡®ä¿æŒ‰æ—¥æœŸé¡ºåºæ’åˆ—
        sortWorkLogs();
        
        const tbody = document.getElementById('worklog').getElementsByTagName('tbody')[0];
        tbody.innerHTML = '';

        if (workLogs.length === 0) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td colspan="5" style="padding: 30px 10px; color: #666; text-align: center;">
                    æš‚æ— è®°å½•ï¼Œè¯·æ·»åŠ ç¬¬ä¸€æ¡å·¥ä½œè®°å½•
                </td>
            `;
            tbody.appendChild(row);
            return;
        }

        workLogs.forEach((log, index) => {
            const row = document.createElement('tr');
            const date = new Date(log.date);
            const month = date.getMonth();
            const monthColors = [
                '#FFEBEE', '#F3E5F5', '#E8EAF6', '#E3F2FD', 
                '#E0F2F1', '#E8F5E8', '#FFF3E0', '#FBE9E7',
                '#EFEBE9', '#FAFAFA', '#ECEFF1', '#FFF8E1'
            ];
            row.style.backgroundColor = monthColors[month];
            
            // å·¥ä½œå†…å®¹æ‘˜è¦ï¼ˆæ˜¾ç¤ºæ›´ç®€çŸ­çš„é¢„è§ˆï¼‰
            const contentPreview = log.content ? 
                (log.content.length > 8 ? log.content.substring(0, 8) + '...' : log.content) : 
                'æ— ';
            
            row.innerHTML = `
                <td>${formatDate(log.date)}</td>
                <td title="${log.content || 'æ— '}">${contentPreview}</td>
                <td>${log.hours}å¤©</td>
                <td>${(log.hours * log.wage).toFixed(2)}å…ƒ</td>
                <td>
                    <div class="table-actions">
                        ${log.content ? `<button class="action-btn view-btn" onclick="showContent(${index})">æŸ¥çœ‹</button>` : ''}
                        <button class="action-btn delete-btn" onclick="showDeleteConfirm(${index})">åˆ é™¤</button>
                    </div>
                </td>
            `;
            tbody.appendChild(row);
        });

        updateSummary();
    }

    function formatDate(dateString) {
        const date = new Date(dateString);
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${month}/${day}`;
    }

    function addWorkLog() {
        const date = document.getElementById('date-input').value;
        const content = document.getElementById('content-input').value.trim();
        const hours = parseFloat(document.getElementById('hours-input').value);
        const wage = parseFloat(document.getElementById('wage-input').value);

        if (!date) {
            showToast("è¯·é€‰æ‹©æ—¥æœŸï¼");
            return;
        }

        if (hours < 0 || isNaN(hours)) {
            showToast("è¯·è¾“å…¥æœ‰æ•ˆçš„å·¥æ—¶æ•°å€¼ï¼ˆâ‰¥0ï¼‰");
            return;
        }

        if (wage < 0 || isNaN(wage)) {
            showToast("è¯·è¾“å…¥æœ‰æ•ˆçš„å·¥èµ„æ•°å€¼ï¼ˆâ‰¥0ï¼‰");
            return;
        }

        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒæ—¥æœŸçš„è®°å½•
        const existingIndex = workLogs.findIndex(log => log.date === date);
        if (existingIndex !== -1) {
            if (confirm('è¯¥æ—¥æœŸå·²æœ‰è®°å½•ï¼Œæ˜¯å¦è¦†ç›–ï¼Ÿ')) {
                workLogs.splice(existingIndex, 1);
            } else {
                showToast("å·²å–æ¶ˆæ·»åŠ ");
                return;
            }
        }

        lastHours = hours;
        lastWage = wage;
        localStorage.setItem('lastHours', hours);
        localStorage.setItem('lastWage', wage);

        workLogs.push({ date, content, hours, wage });
        
        // è‡ªåŠ¨æ•´ç†æ—¥æœŸ
        sortWorkLogs();
        localStorage.setItem('workLogs', JSON.stringify(workLogs));
        
        renderTable();
        clearForm();
        showToast('è®°å½•æ·»åŠ æˆåŠŸï¼');
        
        // æ·»åŠ æˆåŠŸåè‡ªåŠ¨åˆ‡æ¢åˆ°è¡¨æ ¼é¡µ
        setTimeout(() => {
            switchPage('table-page');
        }, 500);
    }

    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.style.display = 'block';
        setTimeout(() => {
            toast.style.display = 'none';
        }, 2000);
    }

    function clearForm() {
        setDefaultDate();
        document.getElementById('content-input').value = '';
        document.getElementById('hours-input').value = lastHours;
        document.getElementById('wage-input').value = lastWage;
    }

    // æ˜¾ç¤ºåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
    function showDeleteConfirm(index) {
        deleteIndex = index;
        const deleteConfirm = document.getElementById('delete-confirm');
        deleteConfirm.style.display = 'flex';
    }

    // ç¡®è®¤åˆ é™¤
    function confirmDelete() {
        if (deleteIndex >= 0 && deleteIndex < workLogs.length) {
            workLogs.splice(deleteIndex, 1);
            // è‡ªåŠ¨æ•´ç†æ—¥æœŸ
            sortWorkLogs();
            localStorage.setItem('workLogs', JSON.stringify(workLogs));
            renderTable();
            showToast('è®°å½•å·²åˆ é™¤');
        }
        cancelDelete();
    }

    // å–æ¶ˆåˆ é™¤
    function cancelDelete() {
        deleteIndex = -1;
        const deleteConfirm = document.getElementById('delete-confirm');
        deleteConfirm.style.display = 'none';
    }

    // æ˜¾ç¤ºåˆ é™¤æ‰€æœ‰æ•°æ®ç¡®è®¤å¯¹è¯æ¡†
    function showDeleteAllConfirm() {
        const deleteAllConfirm = document.getElementById('delete-all-confirm');
        deleteAllConfirm.style.display = 'flex';
    }

    // ç¡®è®¤åˆ é™¤æ‰€æœ‰æ•°æ®
    function confirmDeleteAll() {
        workLogs = [];
        localStorage.removeItem('workLogs');
        localStorage.removeItem('lastWage');
        localStorage.removeItem('lastHours');
        lastWage = 300;
        lastHours = 1;
        
        // æ›´æ–°è¡¨å•é»˜è®¤å€¼
        document.getElementById('hours-input').value = lastHours;
        document.getElementById('wage-input').value = lastWage;
        
        renderTable();
        updateSummary();
        showToast('æ‰€æœ‰æ•°æ®å·²åˆ é™¤');
        cancelDeleteAll();
        
        // åˆ é™¤æˆåŠŸåè‡ªåŠ¨åˆ‡æ¢åˆ°è¡¨æ ¼é¡µ
        setTimeout(() => {
            switchPage('table-page');
        }, 500);
    }

    // å–æ¶ˆåˆ é™¤æ‰€æœ‰æ•°æ®
    function cancelDeleteAll() {
        const deleteAllConfirm = document.getElementById('delete-all-confirm');
        deleteAllConfirm.style.display = 'none';
    }

    function showContent(index) {
        const log = workLogs[index];
        if (!log.content) return;

        const overlay = document.createElement('div');
        overlay.className = 'modal-overlay';
        overlay.onclick = (e) => {
            if (e.target === overlay) overlay.remove();
        };

        const modal = document.createElement('div');
        modal.className = 'modal-content';
        modal.innerHTML = `
            <h3 class="modal-header">${new Date(log.date).toLocaleDateString('zh-CN')} å·¥ä½œè¯¦æƒ…</h3>
            <div class="modal-body">
                ${log.content.replace(/\n/g, '<br>')}
            </div>
            <button class="modal-close" onclick="this.parentElement.parentElement.remove()">
                å…³é—­
            </button>
        `;

        overlay.appendChild(modal);
        document.body.appendChild(overlay);
    }

    function updateSummary() {
        const totalHours = workLogs.reduce((sum, log) => sum + log.hours, 0);
        const totalWage = workLogs.reduce((sum, log) => sum + (log.hours * log.wage), 0);
        
        document.getElementById('total-hours-value').innerText = `${totalHours.toFixed(1)} å¤©`;
        document.getElementById('total-wage-value').innerText = `${totalWage.toFixed(2)} å…ƒ`;

        const monthlyData = {};
        workLogs.forEach(log => {
            const month = new Date(log.date).toLocaleString('zh-CN', { 
                year: 'numeric', 
                month: '2-digit' 
            });
            if (!monthlyData[month]) {
                monthlyData[month] = { hours: 0, wage: 0 };
            }
            monthlyData[month].hours += log.hours;
            monthlyData[month].wage += log.hours * log.wage;
        });

        const monthlyContainer = document.getElementById('monthly-hours');
        monthlyContainer.innerHTML = '';

        if (Object.keys(monthlyData).length === 0) {
            monthlyContainer.innerHTML = '<div style="text-align: center; color: #999; padding: 20px;">æš‚æ— æœˆåº¦æ•°æ®</div>';
            return;
        }

        Object.entries(monthlyData)
            .sort((a, b) => b[0].localeCompare(a[0]))
            .forEach(([month, data]) => {
                const row = document.createElement('div');
                row.className = 'summary-row';
                row.innerHTML = `
                    <span class="summary-label">${month}</span>
                    <span class="summary-value">${data.hours.toFixed(1)}å¤© / ${data.wage.toFixed(2)}å…ƒ</span>
                `;
                monthlyContainer.appendChild(row);
            });
    }

    // é¡µé¢åˆ‡æ¢åŠŸèƒ½
    function switchPage(pageId) {
        // éšè—æ‰€æœ‰é¡µé¢
        const pages = document.querySelectorAll('.page');
        pages.forEach(page => {
            page.classList.remove('active');
        });
        
        // æ˜¾ç¤ºé€‰ä¸­çš„é¡µé¢
        const activePage = document.getElementById(pageId);
        if (activePage) {
            activePage.classList.add('active');
            
            // å¦‚æœæ˜¯è¡¨æ ¼é¡µæˆ–ç»Ÿè®¡é¡µï¼Œæ›´æ–°å†…å®¹
            if (pageId === 'table-page') {
                renderTable();
            } else if (pageId === 'summary-page') {
                updateSummary();
            }
        }
        
        // æ›´æ–°åº•éƒ¨å¯¼èˆªæŒ‰é’®çŠ¶æ€
        const navButtons = document.querySelectorAll('.nav-button');
        navButtons.forEach(button => {
            if (button.getAttribute('onclick') === `switchPage('${pageId}')`) {
                button.classList.add('active');
            } else {
                button.classList.remove('active');
            }
        });
        
        // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
        window.scrollTo(0, 0);
    }

    function exportData() {
        const data = {
            workLogs: workLogs,
            lastWage: lastWage,
            lastHours: lastHours
        };

        const jsonString = JSON.stringify(data, null, 2);
        const blob = new Blob([jsonString], { type: 'application/json' });
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = `å·¥ä½œè®°å½•_${new Date().toISOString().split('T')[0]}.json`;
        
        document.body.appendChild(a);
        a.click();
        
        setTimeout(() => {
            URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }, 100);

        showToast('æ•°æ®å·²å¯¼å‡º');
    }

    function importData() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json,application/json';
        
        input.onchange = function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.workLogs || !Array.isArray(importedData.workLogs)) {
                        throw new Error('æ— æ•ˆçš„æ•°æ®æ ¼å¼');
                    }
                    
                    workLogs = importedData.workLogs;
                    lastWage = importedData.lastWage || 300;
                    lastHours = importedData.lastHours || 1;

                    // å¯¼å…¥åè‡ªåŠ¨æ•´ç†æ—¥æœŸ
                    sortWorkLogs();
                    localStorage.setItem('workLogs', JSON.stringify(workLogs));
                    localStorage.setItem('lastWage', lastWage);
                    localStorage.setItem('lastHours', lastHours);

                    renderTable();
                    updateSummary();
                    showToast('æ•°æ®å¯¼å…¥æˆåŠŸï¼å·²è‡ªåŠ¨æ•´ç†æ—¥æœŸé¡ºåºã€‚');
                    
                    // å¯¼å…¥æˆåŠŸåè‡ªåŠ¨åˆ‡æ¢åˆ°è¡¨æ ¼é¡µ
                    setTimeout(() => {
                        switchPage('table-page');
                    }, 500);
                } catch (error) {
                    showToast('å¯¼å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼');
                    console.error('å¯¼å…¥é”™è¯¯:', error);
                }
            };
            reader.readAsText(file);
        };
        
        input.click();
    }

    // åˆå§‹åŒ–é¡µé¢
    window.onload = () => {
        setDefaultDate();
        
        document.getElementById('hours-input').value = lastHours;
        document.getElementById('wage-input').value = lastWage;
        
        const inputs = document.querySelectorAll('input[type="date"], input[type="text"], input[type="number"]');
        inputs.forEach(input => {
            const originalPlaceholder = input.placeholder;
            
            input.addEventListener('focus', () => {
                input.placeholder = '';
            });
            
            input.addEventListener('blur', () => {
                input.placeholder = originalPlaceholder;
            });
        });
        
        // åˆå§‹æ—¶æ•´ç†æ—¥æœŸ
        sortWorkLogs();
        renderTable();
        updateSummary();
        
        // é»˜è®¤æ˜¾ç¤ºæ·»åŠ é¡µ
        switchPage('add-page');
    };

    // é¡µé¢è·å–ç„¦ç‚¹æ—¶æ›´æ–°æ—¥æœŸ
    window.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
            setDefaultDate();
        }
    });

    // ç‚¹å‡»åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†å¤–éƒ¨å…³é—­å¯¹è¯æ¡†
    document.getElementById('delete-confirm').addEventListener('click', function(e) {
        if (e.target === this) {
            cancelDelete();
        }
    });
    
    // ç‚¹å‡»åˆ é™¤æ‰€æœ‰æ•°æ®ç¡®è®¤å¯¹è¯æ¡†å¤–éƒ¨å…³é—­å¯¹è¯æ¡†
    document.getElementById('delete-all-confirm').addEventListener('click', function(e) {
        if (e.target === this) {
            cancelDeleteAll();
        }
    });

    // æ·»åŠ é”®ç›˜æ”¯æŒï¼šESCé”®å…³é—­åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            cancelDelete();
            cancelDeleteAll();
        }
    });
</script>
</body>
</html>